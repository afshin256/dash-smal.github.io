<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ú¯Ø²Ø§Ø±Ø´ - ØªØ³Øª Firebase</title>
</head>
<body style="background:#000;color:#0ea5b7;padding:20px;font-family:Arial">
  <h2>Ú¯Ø²Ø§Ø±Ø´ Ø³ÙØ§Ø±Ø´Ø§Øª (ÙÙ‚Ø· Ø§Ø² Firebase)</h2>
  <div id="status">Ø¯Ø± Ø­Ø§Ù„ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Firebase...</div>
  <div id="orders"></div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

  <script>
    // ğŸ”‘ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø´Ù…Ø§
    const firebaseConfig = {
      apiKey: "AIzaSyBBGJfA74Ef1haXMbjoW12yYcVNuLcxGEA",
      authDomain: "toucan-restaurant-menu.firebaseapp.com",
      projectId: "toucan-restaurant-menu",
      storageBucket: "toucan-restaurant-menu.firebasestorage.app",
      messagingSenderId: "142624701803",
      appId: "1:142624701803:web:334bbbc313ce35edb6a02e"
    };

    // Initialize
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const statusEl = document.getElementById('status');
    const ordersEl = document.getElementById('orders');

    // ØªØ³Øª Ø§ØªØµØ§Ù„
    db.collection('orders').limit(1).get().then(() => {
      statusEl.textContent = 'âœ… Ù…ØªØµÙ„ Ø´Ø¯. Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø³ÙØ§Ø±Ø´Ø§Øª...';
    }).catch(err => {
      statusEl.innerHTML = `<span style="color:red">âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„: ${err.message}</span>`;
      console.error(err);
    });

    // Ø®ÙˆØ§Ù†Ø¯Ù† Ø³ÙØ§Ø±Ø´Ø§Øª
    db.collection('orders')
      .orderBy('timestamp', 'desc')
      .limit(50)
      .onSnapshot(snapshot => {
        if (snapshot.empty) {
          ordersEl.innerHTML = '<p>Ù‡ÛŒÚ† Ø³ÙØ§Ø±Ø´ÛŒ Ø¯Ø± Firebase ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.</p>';
          return;
        }
        let html = '<ul>';
        snapshot.forEach(doc => {
          const d = doc.data();
          const time = d.timestamp ? d.timestamp.toDate().toLocaleString('fa-IR') : 'Ù†Ø§Ù…Ø´Ø®Øµ';
          html += `<li>Ù…ÛŒØ²: ${d.table || 'â€”'} | Ø²Ù…Ø§Ù†: ${time} | Ø¬Ù…Ø¹: ${d.subtotal || 0} ØªÙˆÙ…Ø§Ù†</li>`;
        });
        html += '</ul>';
        ordersEl.innerHTML = html;
      }, err => {
        ordersEl.innerHTML = `<p style="color:red">Ø®Ø·Ø§ Ø¯Ø± Ø®ÙˆØ§Ù†Ø¯Ù† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§: ${err.message}</p>`;
        console.error(err);
      });
  </script>
</body>
</html>
